<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/google-chart/google-chart.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/iron-input/iron-input.html">

<script src="script/Chart.js"></script>
<dom-module id="my-stats2">

  <template id="app">

    <style>
      :host {
        display: block;
        padding: 10px;
      }
      .card {
        box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -2px rgba(0, 0, 0, 0.2);
        padding: 16px;
        margin: 24px;
        border-radius: 5px;
        background-color: #fff;
        color: #757575;
      }
      .circle {
        display: inline-block;
        height: 64px;
        width: 64px;
        border-radius: 50%;
        background: #ddd;
        line-height: 64px;
        font-size: 30px;
        color: #555;
        text-align: center;
      }
      h1 {
        font-size: 22px;
        margin: 16px 0;
        color: #212121;
      }
      google-chart {
        width: 90%;
      }
      .chart {
        width: 90%;
      }
      canvas{
        background-color : #eee;
        width: 90%;
      }
    </style>

    <iron-ajax auto
        id = "statsAjax1"
        url="{{ip}}/api/admin/stats/revenue"
        params='{"year":"2015", "month":"12", "day":"13", "type":"h"}'
        handle-as="json"
        on-response="stat01_response"
        last-response="{{stats01}}">
    </iron-ajax>

    <iron-ajax auto
        id = "statsAjax2"
        url="{{ip}}/api/admin/stats/revenue"
        params='{"year":"2015", "month":"12", "day":"13", "type":"d"}'
        handle-as="json"
        on-response="stat02_response"
        last-response="{{stats02}}">
    </iron-ajax>

    <iron-ajax auto
        id = "statsAjax3"
        url="{{ip}}/api/admin/stats/revenue"
        params='{"year":"2015", "month":"12", "day":"13", "type":"m"}'
        handle-as="json"
        on-response="stat03_response"
        last-response="{{stats03}}">
    </iron-ajax>

    <div class="card">
      <div class="circle">1</div>
      <h1>Hourly Parking Revenue</h1>
      <p>Parking Revenue in a Day</p>
      <div>
        <label>Date</label>

        <!-- <input is="iron-input" id="dayinput"> -->
        <input id="date1" type="date">
        <paper-button id="name" on-tap="ajaxData1" raised>Update</paper-button>

        <!-- Chart js -->
       <canvas id="chart1"></canvas>

        <!-- <google-chart id="chart1"
          type="column"
          options='{"title": "Daily Revenue Graph"}'>
        </google-chart> -->

      </div>
    </div>

    <div class="card">
      <div class="circle">2</div>
      <h1>Daily Parking Revenue</h1>
      <p>Parking Revenue in a Month</p>
      <div>
        <label>Month</label>


        <input id="date2" type="month">
        <paper-button id="name" on-tap="ajaxData2" raised>Update</paper-button>

        <!-- Chart js -->
       <canvas id="chart2"></canvas>

        <!-- <google-chart id="chart2"
          type="column"
          options='{"title": "Monthly Revenue Graph"}'>
        </google-chart> -->
      </div>
    </div>

    <div class="card">
      <div class="circle">3</div>
      <h1>Monthly Parking Revenue</h1>
      <p>Car Driver Parking Statistics in a year</p>
      <div>
        <label>Year</label>


        <input id="date3" type="month">
        <paper-button id="name" on-tap="ajaxData3" raised>Update</paper-button>

        <!-- Chart js -->
       <canvas id="chart3"></canvas>

        <!-- <google-chart id="chart3"
          type="column"
          options='{"title": "Yearly Revenue Graph"}'>
        </google-chart> -->
      </div>
    </div>


  </template>

  <script>

    Polymer({

      is: 'my-stats2',
      properties:{
        ip: String,
        token : String
      },
      ready : function(){
        console.log(this.ip);
        var token = sessionStorage.getItem("token");
        this.token = token;
        if (!token){
          console.log("token is not existed");
          this.page = "login";

        }

      },
      ajaxData1 : function(){
        var date = this.$.date1.value;
        console.log(date);
        date = date.split("-");
        year = date[0];
        month = date[1];
        day = date[2];
        // console.log(year, month, day);
        this.$.statsAjax1.params = {"token":token, "year":year, "month":month, "day":day, "type":"h"};

        this.$.statsAjax1.generateRequest();

      },
      ajaxData2 : function(){
        var date = this.$.date2.value;
        console.log(date);
        date = date.split("-");
        year = date[0];
        month = date[1];
        // day = date[2];
        // console.log(year, month, day);
        this.$.statsAjax2.params = {"token":token,"year":year, "month":month, "type":"d"};

        this.$.statsAjax2.generateRequest();

      },
      ajaxData3 : function(){
        var date = this.$.date3.value;
        console.log(date);
        date = date.split("-");
        year = date[0];
        month = date[1];
        // day = date[2];
        // console.log(year, month, day);
        this.$.statsAjax3.params = {"token":token,"year":year, "type":"m"};

        this.$.statsAjax3.generateRequest();

      },
      stat01_response: function(request){
<<<<<<< HEAD
        // Chartjs
        var response = this.$.statsAjax1.lastResponse;
        var length = response.length;

        var labels = [];
        var data = []
        response.forEach(function(entry){
          labels.push(entry.slot);
          data.push(entry.count);
        });

        var BarChart = {
            labels: labels,
            datasets: [
            {
              fillColor: "rgba(252,147,65,0.5)",
              strokeColor: "rgba(255,255,255,1)",
              data: data
            }
          ]
        }
        var ctx = this.$.chart1.getContext("2d");
        var myBarChart = new Chart(ctx).Bar(BarChart, {scaleFontSize : 13, scaleFontColor : "#ffa45e"});

        // google chart
        // var response = this.$.statsAjax1.lastResponse;
        // var length = response.length;
        //
        // var dataFrame = '[ ["Hour", "Revenue"]';
        // var cnt = 0;
        // console.log(response);
        // response.forEach(function(entry){
        //   dataFrame += ',["'+ cnt +'", '+entry.count+']';
        //   cnt += 1;
        // });
        //
        // dataFrame = dataFrame + ' ]';
        // console.log(dataFrame);
        //
        // var map = this.$.chart1;
        // map.setAttribute('type', 'column');
        // map.setAttribute('data', dataFrame);

      },
      stat02_response: function(request){

        // Chartjs
        var response = this.$.statsAjax2.lastResponse;
        var length = response.length;

        var labels = [];
        var data = []
        response.forEach(function(entry){
          labels.push(entry.slot);
          data.push(entry.count);
        });

        var BarChart = {
            labels: labels,
            datasets: [
            {
              fillColor: "rgba(252,147,65,0.5)",
              strokeColor: "rgba(255,255,255,1)",
              data: data
            }
          ]
        }
        var ctx = this.$.chart2.getContext("2d");
        var myBarChart = new Chart(ctx).Bar(BarChart, {scaleFontSize : 13, scaleFontColor : "#ffa45e"});

        // google chart
        // var response = this.$.statsAjax2.lastResponse;
        // var length = response.length;
        //
        // var dataFrame = '[ ["Day", "Revenue"]';
        // var cnt = 0;
        // console.log(response);
        // response.forEach(function(entry){
        //   dataFrame += ',["'+ cnt +'", '+entry.count+']';
        //   cnt += 1;
        // });
        //
        // dataFrame = dataFrame + ' ]';
        // console.log(dataFrame);
        //
        // var map = this.$.chart2;
        // map.setAttribute('type', 'column');
        // map.setAttribute('data', dataFrame);

      }
      ,
      stat03_response: function(request){
        // Chartjs
        var response = this.$.statsAjax3.lastResponse;
        var length = response.length;

        var labels = [];
        var data = []
        response.forEach(function(entry){
          labels.push(entry.slot);
          data.push(entry.count);
        });

        var BarChart = {
            labels: labels,
            datasets: [
            {
              fillColor: "rgba(252,147,65,0.5)",
              strokeColor: "rgba(255,255,255,1)",
              data: data
            }
          ]
        }
        var ctx = this.$.chart3.getContext("2d");
        var myBarChart = new Chart(ctx).Bar(BarChart, {scaleFontSize : 13, scaleFontColor : "#ffa45e"});

        // google chart
        // var response = this.$.statsAjax3.lastResponse;
        // var length = response.length;
        //
        // var dataFrame = '[ ["Month", "Revenue"]';
        // var cnt = 0;
        // console.log(response);
        // response.forEach(function(entry){
        //   dataFrame += ',["'+ cnt +'", '+entry.count+']';
        //   cnt += 1;
        // });
        //
        // dataFrame = dataFrame + ' ]';
        // console.log(dataFrame);
        //
        // var map = this.$.chart1;
        // map.setAttribute('type', 'column');
        // map.setAttribute('data', dataFrame);

=======

        var h0 = this.$.statsAjax1.lastResponse.hour0;
        var h1 = this.$.statsAjax1.lastResponse.hour1;
        var h2 = this.$.statsAjax1.lastResponse.hour2;
        var h3 = this.$.statsAjax1.lastResponse.hour3;
        var h4 = this.$.statsAjax1.lastResponse.hour4;
        var h5 = this.$.statsAjax1.lastResponse.hour5;
        var h6 = this.$.statsAjax1.lastResponse.hour6;
        var h7 = this.$.statsAjax1.lastResponse.hour7;
        var h8 = this.$.statsAjax1.lastResponse.hour8;
        var h9 = this.$.statsAjax1.lastResponse.hour9;
        var h10 = this.$.statsAjax1.lastResponse.hour10;
        var h11 = this.$.statsAjax1.lastResponse.hour11;
        var h12 = this.$.statsAjax1.lastResponse.hour12;
        var h13 = this.$.statsAjax1.lastResponse.hour13;
        var h14 = this.$.statsAjax1.lastResponse.hour14;
        var h15 = this.$.statsAjax1.lastResponse.hour15;
        var h16 = this.$.statsAjax1.lastResponse.hour16;
        var h17 = this.$.statsAjax1.lastResponse.hour17;
        var h18 = this.$.statsAjax1.lastResponse.hour18;
        var h19 = this.$.statsAjax1.lastResponse.hour19;
        var h20 = this.$.statsAjax1.lastResponse.hour20;
        var h21 = this.$.statsAjax1.lastResponse.hour21;
        var h22 = this.$.statsAjax1.lastResponse.hour22;
        var h23 = this.$.statsAjax1.lastResponse.hour23;
        var h24 = this.$.statsAjax1.lastResponse.hour24;

        var map = this.$.chart1;
        map.setAttribute('type', 'column');
        map.setAttribute('data', '[ ["Hour", "Revenue"],\
        ["h0", '+h0+'],\
        ["1", '+h1+'],\
        ["2", '+h2+'],\
        ["3", '+h3+'],\
        ["4", '+h4+'],\
        ["5", '+h5+'],\
        ["6", '+h6+'],\
        ["7", '+h7+'],\
        ["8", '+h8+'],\
        ["9", '+h9+'],\
        ["10", '+h10+'],\
        ["11", '+h11+'],\
        ["12", '+h12+'],\
        ["13", '+h13+'],\
        ["14", '+h14+'],\
        ["15", '+h15+'],\
        ["16", '+h16+'],\
        ["17", '+h17+'],\
        ["18", '+h18+'],\
        ["19", '+h19+'],\
        ["20", '+h20+'],\
        ["21", '+h21+'],\
        ["22", '+h22+'],\
        ["23", '+h23+'],\
        ["24", '+h24+'] ]');
      },
      stat02_response: function(request){
        var d1 = this.$.statsAjax2.lastResponse.day1;
        var d2 = this.$.statsAjax2.lastResponse.day2;
        var d3 = this.$.statsAjax2.lastResponse.day3;
        var d4 = this.$.statsAjax2.lastResponse.day4;
        var d5 = this.$.statsAjax2.lastResponse.day5;
        var d6 = this.$.statsAjax2.lastResponse.day6;
        var d7 = this.$.statsAjax2.lastResponse.day7;
        var d8 = this.$.statsAjax2.lastResponse.day8;
        var d9 = this.$.statsAjax2.lastResponse.day9;
        var d10 = this.$.statsAjax2.lastResponse.day10;
        var d11 = this.$.statsAjax2.lastResponse.day11;
        var d12 = this.$.statsAjax2.lastResponse.day12;
        var d13 = this.$.statsAjax2.lastResponse.day13;
        var d14 = this.$.statsAjax2.lastResponse.day14;
        var d15 = this.$.statsAjax2.lastResponse.day15;
        var d16 = this.$.statsAjax2.lastResponse.day16;
        var d17 = this.$.statsAjax2.lastResponse.day17;
        var d18 = this.$.statsAjax2.lastResponse.day18;
        var d19 = this.$.statsAjax2.lastResponse.day19;
        var d20 = this.$.statsAjax2.lastResponse.day20;
        var d21 = this.$.statsAjax2.lastResponse.day21;
        var d22 = this.$.statsAjax2.lastResponse.day22;
        var d23 = this.$.statsAjax2.lastResponse.day23;
        var d24 = this.$.statsAjax2.lastResponse.day24;
        var d25 = this.$.statsAjax2.lastResponse.day25;
        var d26 = this.$.statsAjax2.lastResponse.day26;
        var d27 = this.$.statsAjax2.lastResponse.day27;
        var d28 = this.$.statsAjax2.lastResponse.day28;
        var d29 = this.$.statsAjax2.lastResponse.day29;
        var d30 = this.$.statsAjax2.lastResponse.day30;
        var d31 = this.$.statsAjax2.lastResponse.day31;

        var map = this.$.chart2;
        map.setAttribute('type', 'column');
        map.setAttribute('data', '[ ["Day", "Revenue"],\
        ["1st", '+d1+'],\
        ["2nd", '+d2+'],\
        ["3rd", '+d3+'],\
        ["4th", '+d4+'],\
        ["5", '+d5+'],\
        ["6", '+d6+'],\
        ["7", '+d7+'],\
        ["8", '+d8+'],\
        ["9", '+d9+'],\
        ["10", '+d10+'],\
        ["11", '+d11+'],\
        ["12", '+d12+'],\
        ["13", '+d13+'],\
        ["14", '+d14+'],\
        ["15", '+d15+'],\
        ["16", '+d16+'],\
        ["17", '+d17+'],\
        ["18", '+d18+'],\
        ["19", '+d19+'],\
        ["20", '+d20+'],\
        ["21", '+d21+'],\
        ["22", '+d22+'],\
        ["23", '+d23+'],\
        ["24", '+d24+'],\
        ["25", '+d25+'],\
        ["26", '+d26+'],\
        ["27", '+d27+'],\
        ["28", '+d28+'],\
        ["29", '+d29+'],\
        ["30", '+d30+'],\
        ["31", '+d31+'] ]');
      }
      ,
      stat03_response: function(request){
        var m1 = this.$.statsAjax3.lastResponse.m1;
        var m2 = this.$.statsAjax3.lastResponse.m2;
        var m3 = this.$.statsAjax3.lastResponse.m3;
        var m4 = this.$.statsAjax3.lastResponse.m4;
        var m5 = this.$.statsAjax3.lastResponse.m5;
        var m6 = this.$.statsAjax3.lastResponse.m6;
        var m7 = this.$.statsAjax3.lastResponse.m7;
        var m8 = this.$.statsAjax3.lastResponse.m8;
        var m9 = this.$.statsAjax3.lastResponse.m9;
        var m10 = this.$.statsAjax3.lastResponse.m10;
        var m11 = this.$.statsAjax3.lastResponse.m11;
        var m12 = this.$.statsAjax3.lastResponse.m12;

        var map = this.$.chart3;
        map.setAttribute('type', 'column');
        map.setAttribute('data', '[ ["Month", "Revenue"],\
        ["Jan", '+m1+'],\
        ["Feb", '+m2+'],\
        ["Mar", '+m3+'],\
        ["Apr", '+m4+'],\
        ["May", '+m5+'],\
        ["Jun", '+m6+'],\
        ["Jul", '+m7+'],\
        ["Aug", '+m8+'],\
        ["Sep", '+m9+'],\
        ["Oct", '+m10+'],\
        ["Nov", '+m11+'],\
        ["Dec", '+m12+'] ]');
>>>>>>> parent of 02f45aa... Woojin changed
      }
    });


  </script>

</dom-module>
